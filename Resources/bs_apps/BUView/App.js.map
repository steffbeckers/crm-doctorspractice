{"version":3,"sources":["bs_apps/BUView/App.js","bs_apps/BUView/App.ts"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","throw","result","done","then","apply","BSS","Apps","BUView","node","id","name","subNodes","ko","observableArray","isCurrentRecord","AppViewModel","nodes","currentRecordId","params","Xrm","Page","context","getQueryStringParameters","req","Data","RetrieveMultipleAsync","units","AddSubs","parent","_parentbusinessunitid_value","GlobalHelper","AreGuidEqual","collection","n","businessunitid","push","$","app","applyBindings","onload"],"mappings":"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","file":"bs_apps/BUView/App.js","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator.throw(value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments)).next());\n    });\n};\nvar BSS;\n(function (BSS) {\n    var Apps;\n    (function (Apps) {\n        var BUView;\n        (function (BUView) {\n            class node {\n                constructor(id, name) {\n                    this.subNodes = ko.observableArray();\n                    this.id = id;\n                    this.name = name;\n                    this.isCurrentRecord = false;\n                }\n            }\n            class AppViewModel {\n                constructor() {\n                    this.nodes = ko.observableArray();\n                    this.currentRecordId = null;\n                }\n                onload() {\n                    return __awaiter(this, void 0, void 0, function* () {\n                        var params = Xrm.Page.context.getQueryStringParameters();\n                        if (params['id'])\n                            this.currentRecordId = params['id'];\n                        var req = \"businessunits?$select=name,_parentbusinessunitid_value\";\n                        var units = yield BSS.Data.RetrieveMultipleAsync(req);\n                        this.AddSubs(units, null);\n                    });\n                }\n                AddSubs(units, parent) {\n                    for (let e of units) {\n                        if (!parent && e._parentbusinessunitid_value)\n                            continue;\n                        if (parent && !BSS.GlobalHelper.AreGuidEqual(parent.id, e._parentbusinessunitid_value))\n                            continue;\n                        var collection = (parent ? parent.subNodes : this.nodes);\n                        var n = new node(e.businessunitid, e.name);\n                        n.isCurrentRecord = BSS.GlobalHelper.AreGuidEqual(e.businessunitid, this.currentRecordId);\n                        collection.push(n);\n                        this.AddSubs(units, n);\n                    }\n                }\n            }\n            BUView.AppViewModel = AppViewModel;\n        })(BUView = Apps.BUView || (Apps.BUView = {}));\n    })(Apps = BSS.Apps || (BSS.Apps = {}));\n})(BSS || (BSS = {}));\n// Activates knockout.js\n$(function () {\n    var app = new BSS.Apps.BUView.AppViewModel();\n    ko.applyBindings(app);\n    app.onload();\n});\n","namespace BSS.Apps.BUView\r\n{\r\n    class node\r\n    {\r\n        public id: string;\r\n        public name: string;\r\n        public isCurrentRecord: boolean;\r\n\r\n        public subNodes = ko.observableArray<node>();\r\n\r\n        constructor(id: string, name: string)\r\n        {\r\n            this.id = id;\r\n            this.name = name;\r\n            this.isCurrentRecord = false;\r\n        }\r\n    }\r\n\r\n    export class AppViewModel\r\n    {\r\n        public nodes = ko.observableArray<node>();\r\n        private currentRecordId: string = null;\r\n\r\n        public async onload()\r\n        {\r\n            var params = Xrm.Page.context.getQueryStringParameters();\r\n            if (params['id']) this.currentRecordId = <string>params['id'];\r\n\r\n            var req = \"businessunits?$select=name,_parentbusinessunitid_value\";\r\n            var units = await BSS.Data.RetrieveMultipleAsync(req);\r\n            this.AddSubs(units, null);\r\n        }\r\n\r\n        AddSubs(units: Array<any>, parent: node)\r\n        {\r\n            for (let e of units)\r\n            {\r\n\r\n                if (!parent && e._parentbusinessunitid_value) continue;\r\n                if (parent && !GlobalHelper.AreGuidEqual(parent.id, e._parentbusinessunitid_value)) continue;\r\n\r\n                var collection = (parent ? parent.subNodes : this.nodes);\r\n\r\n                var n = new node(e.businessunitid, e.name);\r\n                n.isCurrentRecord = GlobalHelper.AreGuidEqual(e.businessunitid, this.currentRecordId);\r\n                collection.push(n);\r\n\r\n                this.AddSubs(units, n);\r\n            }\r\n        }\r\n    }\r\n}\r\n// Activates knockout.js\r\n$(function ()\r\n{\r\n    var app = new BSS.Apps.BUView.AppViewModel();\r\n    ko.applyBindings(app);\r\n    app.onload();\r\n});\r\n"],"sourceRoot":"/source/"}