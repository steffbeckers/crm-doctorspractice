{"version":3,"sources":["bs_scripts/Helpers.ts"],"names":["BSS","GlobalHelper","AreGuidEqual","guidA","guidB","replace","toLowerCase","FormHelper","value","field","val","forceSubmit","triggerOnchange","isFieldOnForm","Xrm","Page","getAttribute","getValue","attribute","setValue","setSubmitMode","fireOnChange","hasValue","valueOrDefault","defaultValue","msg","hasFieldsMissing","i","length","showMessage","onForm","isCreate","ui","getFormType","isEditable","isReadonly","onChange","func","scope","wrapper","e","call","addOnChange","onSave","data","entity","save","f","saveFunction","saveWrapper","getEventArgs","isDefaultPrevented","addOnSave","visible","ctrl","getControl","setVisible","getVisible","tabs","getLength","t","get","getName","ii","sections","s","disabled","setDisabled","getDisabled","required","setRequiredLevel","getRequiredLevel","alert","disableForm","onOff","controls","forEach","control","index","controlType","getControlType","doesControlHaveAttribute"],"mappings":";;AAAA,IAAUA,GAAV;AAAA,CAAA,UAAUA,GAAV,EAAa;AAAC,QAAAC,YAAA;AAAA,KAAA,UAAAA,YAAA,EACd;AAEI,iBAAAC,YAAA,CAA6BC,KAA7B,EAA4CC,KAA5C,EAAyD;AAErD,gBAAID,SAASC,KAAb,EACA;AACI,uBAAQD,MAAME,OAAN,CAAc,OAAd,EAAuB,EAAvB,EAA2BC,WAA3B,OAA6CF,MAAMC,OAAN,CAAc,OAAd,EAAuB,EAAvB,EAA2BC,WAA3B,EAArD;AACH;AACD,mBAAO,KAAP;AACH;AAPeL,qBAAAC,YAAA,GAAYA,YAAZ;AAQnB,KAXa,EAAAD,eAAAD,IAAAC,YAAA,KAAAD,IAAAC,YAAA,GAAY,EAAZ,CAAA;AAWb,CAXD,EAAUD,QAAAA,MAAG,EAAH,CAAV;AAaA,IAAUA,GAAV;AAAA,CAAA,UAAUA,GAAV,EAAa;AAAC,QAAAO,UAAA;AAAA,KAAA,UAAAA,UAAA,EACd;AAmCI,iBAAAC,KAAA,CAAsBC,KAAtB,EAAqCC,GAArC,EAAoDC,WAApD,EAA2EC,eAA3E,EAAoG;AAEhG;AACA;AACA;AACA;AACA;AACA;AAEA,gBAAI,CAACC,cAAcJ,KAAd,EAAqB,YAAYA,KAAZ,GAAoB,uBAAzC,CAAL,EAAwE;AAExE,gBAAI,OAAQC,GAAR,IAAgB,WAApB,EAAiC,OAAOI,IAAIC,IAAJ,CAASC,YAAT,CAAsBP,KAAtB,EAA6BQ,QAA7B,EAAP;AAEjC,gBAAIC,YAAYJ,IAAIC,IAAJ,CAASC,YAAT,CAAsBP,KAAtB,CAAhB;AACAS,sBAAUC,QAAV,CAAmBT,GAAnB;AAEA,gBAAIC,WAAJ,EACA;AACIO,0BAAUE,aAAV,CAAwB,QAAxB;AACH;AAED,gBAAIR,eAAJ,EACA;AACIM,0BAAUG,YAAV;AACH;AAED,mBAAOX,GAAP;AACH;AA3BeH,mBAAAC,KAAA,GAAKA,KAAL;AA2Bf;AAED,iBAAAc,QAAA,CAAyBb,KAAzB,EAAsC;AAElC,mBAAOD,MAAMC,KAAN,KAAgB,IAAvB;AACH;AAHeF,mBAAAe,QAAA,GAAQA,QAAR;AAGf;AAED,iBAAAC,cAAA,CAAkCd,KAAlC,EAAiDe,YAAjD,EAAiE;AAE7D,gBAAIF,SAASb,KAAT,CAAJ,EAAqB,OAAOD,MAAMC,KAAN,CAAP;AACrB,mBAAOe,YAAP;AACH;AAJejB,mBAAAgB,cAAA,GAAcA,cAAd;AAIf;AAED,iBAAAV,aAAA,CAA8BJ,KAA9B,EAA6CgB,GAA7C,EAAyD;AAErD;AACA;AACA;AACA;AAEA,gBAAI,OAAQhB,KAAR,KAAmB,QAAvB,EACA;AACI,oBAAIiB,mBAAmB,KAAvB;AAEA,qBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIlB,MAAMmB,MAA1B,EAAkCD,GAAlC,EACA;AACI,wBAAI,CAACd,cAAcJ,MAAMkB,CAAN,CAAd,CAAL,EAA8BD,mBAAmB,IAAnB;AACjC;AAED,oBAAIA,oBAAoBD,GAAxB,EACA;AACII,gCAAYJ,GAAZ;AACH;AAED,uBAAO,CAACC,gBAAR;AACH;AAED,gBAAII,SAAShB,IAAIC,IAAJ,CAASC,YAAT,CAAsBP,KAAtB,KAAgC,IAA7C;AAEA,gBAAI,CAACqB,MAAD,IAAWL,GAAf,EACA;AACII,4BAAYJ,GAAZ;AACH;AAED,mBAAOK,MAAP;AACH;AAhCevB,mBAAAM,aAAA,GAAaA,aAAb;AAgCf;AAED,iBAAAkB,QAAA,GAAA;AAEI;AACA;AAEA,mBAAOjB,IAAIC,IAAJ,CAASiB,EAAT,CAAYC,WAAZ,MAA6B,CAApC;AACH;AANe1B,mBAAAwB,QAAA,GAAQA,QAAR;AAMf;AAED,iBAAAG,UAAA,GAAA;AAEI;AACA;AAEA,mBAAOpB,IAAIC,IAAJ,CAASiB,EAAT,CAAYC,WAAZ,MAA6B,CAA7B,IACHnB,IAAIC,IAAJ,CAASiB,EAAT,CAAYC,WAAZ,MAA6B,CADjC;AAEH;AAPe1B,mBAAA2B,UAAA,GAAUA,UAAV;AAOf;AAED,iBAAAC,UAAA,GAAA;AAEI;AACA;AACA,mBAAOrB,IAAIC,IAAJ,CAASiB,EAAT,CAAYC,WAAZ,MAA6B,CAA7B,IACHnB,IAAIC,IAAJ,CAASiB,EAAT,CAAYC,WAAZ,MAA6B,CAD1B,IAEHnB,IAAIC,IAAJ,CAASiB,EAAT,CAAYC,WAAZ,MAA6B,EAFjC;AAGH;AAPe1B,mBAAA4B,UAAA,GAAUA,UAAV;AAOf;AAED,iBAAAC,QAAA,CAAyB3B,KAAzB,EAAwC4B,IAAxC,EAA8EC,KAA9E,EAAyF;AAErF;AACA;AACA;AAEA,gBAAI,CAACzB,cAAcJ,KAAd,CAAL,EACA;AACIoB,4BAAYpB,QAAQ,4BAApB;AACA;AACH;AAED,gBAAI4B,IAAJ,EACA;AACI,oBAAIC,KAAJ,EACA;AACI,wBAAIC,UAAU,UAAUF,IAAV,EAAgDC,KAAhD,EAA2D;AAErE,4BAAIF,WAAW,SAAXA,QAAW,CAAUI,CAAV,EAAW;AAEtBH,iCAAKI,IAAL,CAAUH,KAAV,EAAiBE,CAAjB;AACH,yBAHD;AAKA,+BAAO;AACHJ,sCAAUA;AADP,yBAAP;AAGH,qBAVa,CAUXC,IAVW,EAULC,KAVK,CAAd;AAYAxB,wBAAIC,IAAJ,CAASC,YAAT,CAAsBP,KAAtB,EAA6BiC,WAA7B,CAAyCH,QAAQH,QAAjD;AACH,iBAfD,MAiBA;AACItB,wBAAIC,IAAJ,CAASC,YAAT,CAAsBP,KAAtB,EAA6BiC,WAA7B,CAAyCL,IAAzC;AACH;AACD;AACH;AAEDvB,gBAAIC,IAAJ,CAASC,YAAT,CAAsBP,KAAtB,EAA6BY,YAA7B;AACH;AAtCed,mBAAA6B,QAAA,GAAQA,QAAR;AAsCf;AAED,iBAAAO,MAAA,CAAuBN,IAAvB,EAA0D;AAEtD;AACA;AAEA,gBAAI,CAACA,IAAL,EACA;AACIvB,oBAAIC,IAAJ,CAAS6B,IAAT,CAAcC,MAAd,CAAqBC,IAArB;AACA;AACH;AAED,gBAAIP,UAAU,UAAUQ,CAAV,EAAW;AAErB,oBAAIC,eAAeD,CAAnB;AAEA,oBAAIE,cAAc,SAAdA,WAAc,CAAUT,CAAV,EAAW;AAEzB,wBAAIA,EAAEU,YAAF,GAAiBC,kBAAjB,EAAJ,EAA2C;AAE3CH,iCAAaR,CAAb;AACH,iBALD;AAOA,uBAAO;AACHM,0BAAMG;AADH,iBAAP;AAGH,aAda,CAcXZ,IAdW,CAAd;AAgBAvB,gBAAIC,IAAJ,CAAS6B,IAAT,CAAcC,MAAd,CAAqBO,SAArB,CAA+Bb,QAAQO,IAAvC;AACH;AA5BevC,mBAAAoC,MAAA,GAAMA,MAAN;AA4Bf;AAED,iBAAAU,OAAA,CAAwB5C,KAAxB,EAAuCC,GAAvC,EAAoD;AAEhD;AACA;AACA;AAEA,gBAAIG,cAAcJ,KAAd,CAAJ,EACA;AACI,oBAAIC,OAAO,IAAX,EACA;AACI,wBAAI4C,OAAOxC,IAAIC,IAAJ,CAASwC,UAAT,CAAoB9C,KAApB,CAAX;AAEA6C,yBAAKE,UAAL,CAAgB9C,GAAhB;AAEA,2BAAOA,GAAP;AACH,iBAPD,MASA;AACI,2BAAOI,IAAIC,IAAJ,CAASwC,UAAT,CAAoB9C,KAApB,EAA2BgD,UAA3B,EAAP;AACH;AACJ;AAED,iBAAK,IAAI9B,IAAI,CAAb,EAAgBA,IAAIb,IAAIC,IAAJ,CAASiB,EAAT,CAAY0B,IAAZ,CAAiBC,SAAjB,EAApB,EAAkDhC,GAAlD,EACA;AACI,oBAAIiC,IAAI9C,IAAIC,IAAJ,CAASiB,EAAT,CAAY0B,IAAZ,CAAiBG,GAAjB,CAAqBlC,CAArB,CAAR;AACA,oBAAIiC,EAAEE,OAAF,MAAerD,KAAnB,EACA;AACI,wBAAIC,OAAO,IAAX,EACA;AACIkD,0BAAEJ,UAAF,CAAa9C,GAAb;AACA,+BAAOA,GAAP;AACH,qBAJD,MAMA;AACI,+BAAOkD,EAAEH,UAAF,EAAP;AACH;AACJ;AAED,qBAAK,IAAIM,KAAK,CAAd,EAAiBA,KAAKH,EAAEI,QAAF,CAAWL,SAAX,EAAtB,EAA8CI,IAA9C,EACA;AACI,wBAAIE,IAAIL,EAAEI,QAAF,CAAWH,GAAX,CAAeE,EAAf,CAAR;AACA,wBAAIE,EAAEH,OAAF,MAAerD,KAAnB,EACA;AACI,4BAAIC,OAAO,IAAX,EACA;AACIuD,8BAAET,UAAF,CAAa9C,GAAb;AACA,mCAAOA,GAAP;AACH,yBAJD,MAMA;AACI,mCAAOuD,EAAER,UAAF,EAAP;AACH;AACJ;AACJ;AACJ;AAED5B,wBAAY,6CAA6CpB,KAA7C,GAAqD,GAAjE;AACH;AAzDeF,mBAAA8C,OAAA,GAAOA,OAAP;AA2DhB,iBAAAa,QAAA,CAAyBzD,KAAzB,EAAwCC,GAAxC,EAAqD;AAEjD,gBAAI,CAACG,cAAcJ,KAAd,EAAqB,YAAYA,KAAZ,GAAoB,uBAAzC,CAAL,EAAwE;AAExE,gBAAIC,OAAO,IAAX,EACA;AACI,oBAAI4C,OAAOxC,IAAIC,IAAJ,CAASwC,UAAT,CAAoB9C,KAApB,CAAX;AAEA6C,qBAAKa,WAAL,CAAiBzD,GAAjB;AACH,aALD,MAOA;AACI,uBAAOI,IAAIC,IAAJ,CAASwC,UAAT,CAAoB9C,KAApB,EAA2B2D,WAA3B,EAAP;AACH;AACJ;AAde7D,mBAAA2D,QAAA,GAAQA,QAAR;AAgBhB,iBAAAG,QAAA,CAAyB5D,KAAzB,EAAwCC,GAAxC,EAAqD;AAEjD;AACA;AACA;AAEA,gBAAI,CAACG,cAAcJ,KAAd,EAAqB,YAAYA,KAAZ,GAAoB,uBAAzC,CAAL,EAAwE;AAExE,gBAAIC,OAAO,IAAX,EACA;AACI,oBAAI4C,OAAOxC,IAAIC,IAAJ,CAASC,YAAT,CAAsBP,KAAtB,CAAX;AAEA6C,qBAAKgB,gBAAL,CAAsB5D,MAAM,UAAN,GAAmB,MAAzC;AACH,aALD,MAOA;AACI,uBAAOI,IAAIC,IAAJ,CAASC,YAAT,CAAsBP,KAAtB,EAA6B8D,gBAA7B,MAAmD,UAA1D;AACH;AACJ;AAlBehE,mBAAA8D,QAAA,GAAQA,QAAR;AAoBhB,iBAAAxC,WAAA,CAA4BJ,GAA5B,EAAuC;AAEnC;AACA+C,kBAAM/C,GAAN;AACH;AAJelB,mBAAAsB,WAAA,GAAWA,WAAX;AAMhB,iBAAA4C,WAAA,CAA4BC,KAA5B,EAA0C;AACtC5D,gBAAIC,IAAJ,CAASiB,EAAT,CAAY2C,QAAZ,CAAqBC,OAArB,CAA6B,UAAUC,OAAV,EAAmBC,KAAnB,EAAwB;AACjD,oBAAIC,cAAcF,QAAQG,cAAR,EAAlB;AACA,oBAAIC,2BAA4BF,eAAe,QAAf,IAA2BA,eAAe,aAA1C,IAA2DA,eAAe,SAA1G;AACA,oBAAIE,wBAAJ,EAA8B;AAC1BJ,4BAAQV,WAAR,CAAoBO,KAApB;AACH;AACJ,aAND;AAOH;AARenE,mBAAAkE,WAAA,GAAWA,WAAX;AASnB,KA5Ta,EAAAlE,aAAAP,IAAAO,UAAA,KAAAP,IAAAO,UAAA,GAAU,EAAV,CAAA;AA4Tb,CA5TD,EAAUP,QAAAA,MAAG,EAAH,CAAV","file":"bs_scripts/Helpers.js","sourcesContent":["namespace BSS.GlobalHelper\r\n{\r\n\r\n    export function AreGuidEqual(guidA: string, guidB: string)\r\n    {\r\n        if (guidA && guidB)\r\n        {\r\n            return (guidA.replace(/[{}]/g, \"\").toLowerCase() === guidB.replace(/[{}]/g, \"\").toLowerCase());\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\nnamespace BSS.FormHelper\r\n{\r\n    export interface iEventContext\r\n    {\r\n        getEventArgs: () => iEventArgument;\r\n    }\r\n\r\n    export interface iEventArgument\r\n    {\r\n        /**\r\n        * Method that returns the Client- side context (client - side reference) object.\r\n        */\r\n        getContext: () => any;\r\n\r\n        /**\r\n        * Method that returns a value that indicates the order in which this handler is executed.\r\n        */\r\n        getDepth: () => number;\r\n\r\n        /**\r\n        * Method that returns an object with methods to manage the Save event.\r\n        */\r\n        getEventArgs: () => any;\r\n\r\n\r\n        /**\r\n        * Method that returns a reference to the object that the event occurred on.\r\n        */\r\n        getEventSource: () => any;\r\n\r\n        /**\r\n        * Shared variables allow sharing of a variable with other handlers for the same event.You use the setSharedVariable and getSharedVariable methods to work with shared variables.\r\n        */\r\n        Sharedvariables: () => any;\r\n    }\r\n\r\n    export function value(field: string, val?: boolean, forceSubmit?: boolean, triggerOnchange?: boolean)\r\n    {\r\n        ///<summary>Gets or sets the value of a field.</summary>\r\n        ///<param name=\"field\" type=\"String\">Field name</param>\r\n        ///<param name=\"val\" type=\"Object\">Sets the data value for an attribute.</param>\r\n        ///<param name=\"forceSubmit\" type=\"Boolean\">Sets whether data from the attribute will be submitted when the record is saved.</param>\r\n        ///<param name=\"triggerOnchange\" type=\"Boolean\">Causes the OnChange event to occur on the attribute so that any script associated to that event can execute. </param>\r\n        ///<returns type=\"Object\"></returns>\r\n\r\n        if (!isFieldOnForm(field, \"Field '\" + field + \"' is not on the form.\")) return;\r\n\r\n        if (typeof (val) == \"undefined\") return Xrm.Page.getAttribute(field).getValue();\r\n\r\n        var attribute = Xrm.Page.getAttribute(field);\r\n        attribute.setValue(val);\r\n\r\n        if (forceSubmit)\r\n        {\r\n            attribute.setSubmitMode(\"always\");\r\n        }\r\n\r\n        if (triggerOnchange)\r\n        {\r\n            attribute.fireOnChange();\r\n        }\r\n\r\n        return val;\r\n    };\r\n\r\n    export function hasValue(field: string)\r\n    {\r\n        return value(field) != null;\r\n    };\r\n\r\n    export function valueOrDefault<T>(field: string, defaultValue?: T)\r\n    {\r\n        if (hasValue(field)) return value(field);\r\n        return defaultValue;\r\n    };\r\n\r\n    export function isFieldOnForm(field: string, msg?: string)\r\n    {\r\n        ///<summary>Checks if a field is on the form.</summary>\r\n        ///<param name=\"field\" type=\"String\">Field name</param>\r\n        ///<param name=\"msg\" type=\"String\">Set a notification for the user when the field is not on the form.</param>\r\n        ///<returns type=\"Boolean\"></returns>\r\n\r\n        if (typeof (field) !== \"string\")\r\n        {\r\n            var hasFieldsMissing = false;\r\n\r\n            for (var i = 0; i < field.length; i++)\r\n            {\r\n                if (!isFieldOnForm(field[i])) hasFieldsMissing = true;\r\n            }\r\n\r\n            if (hasFieldsMissing && msg)\r\n            {\r\n                showMessage(msg);\r\n            }\r\n\r\n            return !hasFieldsMissing;\r\n        }\r\n\r\n        var onForm = Xrm.Page.getAttribute(field) != null;\r\n\r\n        if (!onForm && msg)\r\n        {\r\n            showMessage(msg);\r\n        }\r\n\r\n        return onForm;\r\n    };\r\n\r\n    export function isCreate()\r\n    {\r\n        ///<summary>Is the current form a Create form.</summary>\r\n        ///<returns type=\"Bool\"></returns>\r\n\r\n        return Xrm.Page.ui.getFormType() == 1;\r\n    };\r\n\r\n    export function isEditable()\r\n    {\r\n        ///<summary>Is the current form a Create or Update form.</summary>\r\n        ///<returns type=\"Bool\"></returns>\r\n\r\n        return Xrm.Page.ui.getFormType() == 1 ||\r\n            Xrm.Page.ui.getFormType() == 2;\r\n    };\r\n\r\n    export function isReadonly()\r\n    {\r\n        ///<summary>Is the current form a Read Only, Disabled or Read Optimized form.</summary>\r\n        ///<returns type=\"Bool\"></returns>\r\n        return Xrm.Page.ui.getFormType() == 3 ||\r\n            Xrm.Page.ui.getFormType() == 4 ||\r\n            Xrm.Page.ui.getFormType() == 11;\r\n    };\r\n\r\n    export function onChange(field: string, func?: (ctx?: iEventContext) => void, scope?: any)\r\n    {\r\n        ///<summary>Sets or triggers the function to be called when the attribute value is changed.</summary>\r\n        ///<param name=\"field\" type=\"String\">Field name</param>\r\n        ///<param name=\"func\" type=\"Delegate\"></param>\r\n\r\n        if (!isFieldOnForm(field))\r\n        {\r\n            showMessage(field + ' field is not on the form.');\r\n            return;\r\n        }\r\n\r\n        if (func)\r\n        {\r\n            if (scope)\r\n            {\r\n                var wrapper = function (func?: (ctx?: iEventContext) => void, scope?: any)\r\n                {\r\n                    var onChange = function (e)\r\n                    {\r\n                        func.call(scope, e);\r\n                    };\r\n\r\n                    return {\r\n                        onChange: onChange\r\n                    }\r\n                } (func, scope);\r\n\r\n                Xrm.Page.getAttribute(field).addOnChange(wrapper.onChange);\r\n            }\r\n            else\r\n            {\r\n                Xrm.Page.getAttribute(field).addOnChange(func);\r\n            }\r\n            return;\r\n        }\r\n\r\n        Xrm.Page.getAttribute(field).fireOnChange();\r\n    };\r\n\r\n    export function onSave(func: (ctx?: iEventContext) => void)\r\n    {\r\n        ///<summary>Sets or triggers the function to be called when the form is saved.</summary>\r\n        ///<param name=\"func\" type=\"Delegate\"></param>\r\n\r\n        if (!func)\r\n        {\r\n            Xrm.Page.data.entity.save();\r\n            return;\r\n        }\r\n\r\n        var wrapper = function (f)\r\n        {\r\n            var saveFunction = f;\r\n\r\n            var saveWrapper = function (e)\r\n            {\r\n                if (e.getEventArgs().isDefaultPrevented()) return;\r\n\r\n                saveFunction(e);\r\n            };\r\n\r\n            return {\r\n                save: saveWrapper\r\n            };\r\n        } (func);\r\n\r\n        Xrm.Page.data.entity.addOnSave(wrapper.save);\r\n    };\r\n\r\n    export function visible(field: string, val?: boolean)\r\n    {\r\n        /// <summary>Hide or show a field on the form (Todo: section and tabs not yet possible)</summary>\r\n        /// <param name=\"field\" type=\"Object\"></param>\r\n        /// <param name=\"val\" type=\"Object\"></param>\r\n\r\n        if (isFieldOnForm(field))\r\n        {\r\n            if (val != null)\r\n            {\r\n                var ctrl = Xrm.Page.getControl(field);\r\n\r\n                ctrl.setVisible(val);\r\n\r\n                return val;\r\n            }\r\n            else\r\n            {\r\n                return Xrm.Page.getControl(field).getVisible();\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < Xrm.Page.ui.tabs.getLength(); i++)\r\n        {\r\n            var t = Xrm.Page.ui.tabs.get(i);\r\n            if (t.getName() == field)\r\n            {\r\n                if (val != null)\r\n                {\r\n                    t.setVisible(val);\r\n                    return val;\r\n                }\r\n                else\r\n                {\r\n                    return t.getVisible();\r\n                }\r\n            }\r\n\r\n            for (var ii = 0; ii < t.sections.getLength(); ii++)\r\n            {\r\n                var s = t.sections.get(ii);\r\n                if (s.getName() == field)\r\n                {\r\n                    if (val != null)\r\n                    {\r\n                        s.setVisible(val);\r\n                        return val;\r\n                    }\r\n                    else\r\n                    {\r\n                        return s.getVisible();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        showMessage(\"Field, section or tab not fond on form (\" + field + \")\");\r\n    }\r\n\r\n    export function disabled(field: string, val?: boolean)\r\n    {\r\n        if (!isFieldOnForm(field, \"Field '\" + field + \"' is not on the form.\")) return;\r\n\r\n        if (val != null)\r\n        {\r\n            var ctrl = Xrm.Page.getControl(field);\r\n\r\n            ctrl.setDisabled(val);\r\n        }\r\n        else\r\n        {\r\n            return Xrm.Page.getControl(field).getDisabled();\r\n        }\r\n    }\r\n\r\n    export function required(field: string, val?: boolean)\r\n    {\r\n        /// <summary>Set required level for a field</summary>\r\n        /// <param name=\"field\" type=\"String\"></param>\r\n        /// <param name=\"val\" type=\"Object\"></param>\r\n\r\n        if (!isFieldOnForm(field, \"Field '\" + field + \"' is not on the form.\")) return;\r\n\r\n        if (val != null)\r\n        {\r\n            var ctrl = Xrm.Page.getAttribute(field);\r\n\r\n            ctrl.setRequiredLevel(val ? \"required\" : \"none\");\r\n        }\r\n        else\r\n        {\r\n            return Xrm.Page.getAttribute(field).getRequiredLevel() == \"required\";\r\n        }\r\n    }\r\n\r\n    export function showMessage(msg: string)\r\n    {\r\n        // todo don't use alert\r\n        alert(msg);\r\n    }\r\n\r\n    export function disableForm(onOff: boolean) {\r\n        Xrm.Page.ui.controls.forEach(function (control, index) {\r\n            var controlType = control.getControlType();\r\n            var doesControlHaveAttribute = (controlType != \"iframe\" && controlType != \"webresource\" && controlType != \"subgrid\");\r\n            if (doesControlHaveAttribute) {\r\n                control.setDisabled(onOff);\r\n            }\r\n        });\r\n    }\r\n}"],"sourceRoot":"/source/"}