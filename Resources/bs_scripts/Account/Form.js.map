{"version":3,"sources":["bs_scripts/Account/Form.js","bs_scripts/Account/Form.ts"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","throw","result","done","then","apply","BSS","Account","Form","OnLoad","createUpdate","CreateUpdateForm","init","accountHeader","AccountHeaderLogic","dealerSetting","DealerSettingLogic","qualityAssessment","QualityAssessmentLogic","setCreateTabVisible","create","FormHelper","isCreate","setTabVisible","tabName","show","tab","Xrm","Page","ui","tabs","get","setVisible","showAccountHeaderFields","onChange","section","sections","controls","controlsLenght","length","i","getAttribute","setValue","disabled","getName","SetDealerSettingsReadOnly","SetIntegration","enabled","fieldList","l","index","onewayintegration","showQualityAssessment","accountSubTypeReference","columnList","Data","RetrieveAsync","accountSubType"],"mappings":"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","file":"bs_scripts/Account/Form.js","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator.throw(value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments)).next());\n    });\n};\nvar BSS;\n(function (BSS) {\n    var Account;\n    (function (Account) {\n        var Form;\n        (function (Form) {\n            function OnLoad() {\n                var createUpdate = new CreateUpdateForm();\n                createUpdate.init();\n                var accountHeader = new AccountHeaderLogic();\n                accountHeader.init();\n                var dealerSetting = new DealerSettingLogic();\n                dealerSetting.init();\n                var qualityAssessment = new QualityAssessmentLogic();\n                qualityAssessment.init();\n            }\n            Form.OnLoad = OnLoad;\n            class CreateUpdateForm {\n                init() {\n                    this.setCreateTabVisible();\n                }\n                setCreateTabVisible() {\n                    var create = BSS.FormHelper.isCreate();\n                    this.setTabVisible(\"tab_Create\", create);\n                    this.setTabVisible(\"General\", !create);\n                    this.setTabVisible(\"DealerSettings\", !create);\n                }\n                setTabVisible(tabName, show) {\n                    var tab = Xrm.Page.ui.tabs.get(tabName);\n                    if (tab == null)\n                        return;\n                    tab.setVisible(show);\n                }\n            }\n            class AccountHeaderLogic {\n                init() {\n                    if (!BSS.FormHelper.isCreate())\n                        return;\n                    this.showAccountHeaderFields();\n                    BSS.FormHelper.onChange(\"bs_accountheaderid\", this.showAccountHeaderFields);\n                }\n                showAccountHeaderFields() {\n                    var accountHeader = BSS.FormHelper.value(\"bs_accountheaderid\");\n                    var value = (accountHeader == null);\n                    var tab = Xrm.Page.ui.tabs.get(\"tab_Create\");\n                    if (tab == null)\n                        return;\n                    var section = tab.sections.get(\"CreateHeader\");\n                    if (section == null)\n                        return;\n                    var controls = section.controls.get();\n                    var controlsLenght = controls.length;\n                    for (var i = 0; i < controlsLenght; i++) {\n                        if (!value) {\n                            controls[i].getAttribute().setValue(null);\n                        }\n                        BSS.FormHelper.disabled(controls[i].getName(), !value);\n                    }\n                }\n            }\n            class DealerSettingLogic {\n                init() {\n                    if (BSS.FormHelper.isCreate())\n                        return;\n                    this.SetDealerSettingsReadOnly();\n                    BSS.FormHelper.onChange(\"bs_enablesettings\", this.SetDealerSettingsReadOnly);\n                    BSS.FormHelper.onChange(\"bs_enablesettings\", this.SetIntegration);\n                    this.SetIntegration();\n                    BSS.FormHelper.onChange(\"bs_onewayintegration\", this.SetIntegration);\n                }\n                SetDealerSettingsReadOnly() {\n                    var enabled = BSS.FormHelper.value(\"bs_enablesettings\");\n                    var value = (enabled === 500000000);\n                    var fieldList = [\"bs_restrictfleets\", \"bs_replenishment\", \"bs_fleetstock\", \"bs_onewayintegration\"];\n                    var l = fieldList.length;\n                    for (var index = 0; index < l; ++index) {\n                        BSS.FormHelper.disabled(fieldList[index], value);\n                    }\n                }\n                SetIntegration() {\n                    var onewayintegration = BSS.FormHelper.value(\"bs_onewayintegration\");\n                    var enabled = BSS.FormHelper.value(\"bs_enablesettings\");\n                    var value = (onewayintegration != true);\n                    if (value == false) {\n                        value = (enabled === 500000000);\n                    }\n                    var fieldList = [\"bs_protocol\", \"bs_url\", \"bs_username\", \"bs_port\", \"bs_path\", \"bs_password\"];\n                    var l = fieldList.length;\n                    for (var index = 0; index < l; ++index) {\n                        BSS.FormHelper.disabled(fieldList[index], value);\n                    }\n                }\n            }\n            class QualityAssessmentLogic {\n                init() {\n                    if (BSS.FormHelper.isCreate())\n                        return;\n                    this.showQualityAssessment();\n                    BSS.FormHelper.onChange(\"bs_accountsubtypeid\", this.showQualityAssessment);\n                }\n                showQualityAssessment() {\n                    return __awaiter(this, void 0, void 0, function* () {\n                        if (BSS.FormHelper.isCreate())\n                            return;\n                        var accountSubTypeReference = BSS.FormHelper.value(\"bs_accountsubtypeid\");\n                        if (accountSubTypeReference == null)\n                            return;\n                        var columnList = [\"bs_qualityassessment\"];\n                        var accountSubType = yield BSS.Data.RetrieveAsync(\"bs_accountsubtype\", accountSubTypeReference[0]['id'], columnList);\n                        var show = (accountSubType[\"bs_qualityassessment\"] == true);\n                        var tab = Xrm.Page.ui.tabs.get(\"QualityAssessment\");\n                        if (tab == null)\n                            return;\n                        tab.setVisible(show);\n                    });\n                }\n            }\n        })(Form = Account.Form || (Account.Form = {}));\n    })(Account = BSS.Account || (BSS.Account = {}));\n})(BSS || (BSS = {}));\n","namespace BSS.Account.Form {\r\n    export function OnLoad() {\r\n        var createUpdate = new CreateUpdateForm();\r\n        createUpdate.init();\r\n        var accountHeader = new AccountHeaderLogic();\r\n        accountHeader.init();\r\n        var dealerSetting = new DealerSettingLogic();\r\n        dealerSetting.init();\r\n        var qualityAssessment = new QualityAssessmentLogic();\r\n        qualityAssessment.init();\r\n    }\r\n\r\n    class CreateUpdateForm {\r\n        public init() {\r\n            this.setCreateTabVisible();\r\n        }\r\n\r\n        private setCreateTabVisible() {\r\n            var create = FormHelper.isCreate();\r\n\r\n            this.setTabVisible(\"tab_Create\", create);\r\n            this.setTabVisible(\"General\", !create);\r\n            this.setTabVisible(\"DealerSettings\", !create);\r\n        }\r\n\r\n        private setTabVisible(tabName, show) {\r\n            var tab = Xrm.Page.ui.tabs.get(tabName);\r\n            if (tab == null) return;\r\n            tab.setVisible(show);\r\n        }\r\n    }\r\n\r\n    class AccountHeaderLogic {\r\n        public init() {\r\n            if(!FormHelper.isCreate()) return;\r\n            this.showAccountHeaderFields();\r\n            FormHelper.onChange(\"bs_accountheaderid\", this.showAccountHeaderFields);\r\n        }\r\n\r\n        private showAccountHeaderFields() {\r\n            var accountHeader = FormHelper.value(\"bs_accountheaderid\");\r\n            var value = (accountHeader == null);\r\n\r\n            var tab = Xrm.Page.ui.tabs.get(\"tab_Create\");\r\n            if (tab == null) return;\r\n            var section = tab.sections.get(\"CreateHeader\");\r\n            if (section == null) return;\r\n            var controls = section.controls.get();\r\n            var controlsLenght = controls.length;\r\n\r\n            for (var i = 0; i < controlsLenght; i++) {\r\n                if (!value) {\r\n                    controls[i].getAttribute().setValue(null);\r\n                }\r\n\r\n                FormHelper.disabled(controls[i].getName() ,!value);\r\n            }\r\n        }\r\n    }\r\n\r\n    class DealerSettingLogic {\r\n        public init() {\r\n            if (FormHelper.isCreate()) return;\r\n            this.SetDealerSettingsReadOnly();\r\n            FormHelper.onChange(\"bs_enablesettings\", this.SetDealerSettingsReadOnly);\r\n            FormHelper.onChange(\"bs_enablesettings\", this.SetIntegration);\r\n            this.SetIntegration();\r\n            FormHelper.onChange(\"bs_onewayintegration\", this.SetIntegration);\r\n        }\r\n\r\n        private SetDealerSettingsReadOnly() {\r\n            var enabled = FormHelper.value(\"bs_enablesettings\");\r\n            var value = (enabled === 500000000);\r\n            var fieldList = [\"bs_restrictfleets\", \"bs_replenishment\", \"bs_fleetstock\", \"bs_onewayintegration\"];\r\n\r\n            var l = fieldList.length;\r\n            for (var index = 0; index < l; ++index) {\r\n                FormHelper.disabled(fieldList[index], value);\r\n            }\r\n        }\r\n\r\n        private SetIntegration() {\r\n            var onewayintegration = FormHelper.value(\"bs_onewayintegration\");\r\n            var enabled = FormHelper.value(\"bs_enablesettings\");\r\n\r\n            var value = (onewayintegration != true)\r\n            if (value == false) {\r\n               value = (enabled === 500000000);\r\n            }\r\n            var fieldList = [\"bs_protocol\", \"bs_url\", \"bs_username\", \"bs_port\", \"bs_path\", \"bs_password\"];\r\n\r\n            var l = fieldList.length;\r\n            for (var index = 0; index < l; ++index) {\r\n                FormHelper.disabled(fieldList[index], value);\r\n            }\r\n        }\r\n    }\r\n\r\n    class QualityAssessmentLogic {\r\n        public init() {\r\n            if (FormHelper.isCreate()) return;\r\n            this.showQualityAssessment();\r\n            FormHelper.onChange(\"bs_accountsubtypeid\", this.showQualityAssessment);\r\n        }\r\n\r\n        private async showQualityAssessment() {\r\n            if(FormHelper.isCreate()) return;\r\n            \r\n            var accountSubTypeReference = FormHelper.value(\"bs_accountsubtypeid\");\r\n            if (accountSubTypeReference == null) return;\r\n            var columnList = [\"bs_qualityassessment\"];\r\n            var accountSubType = await Data.RetrieveAsync(\"bs_accountsubtype\", accountSubTypeReference[0]['id'], columnList);\r\n            var show = (accountSubType[\"bs_qualityassessment\"] == true);\r\n            var tab = Xrm.Page.ui.tabs.get(\"QualityAssessment\");\r\n            if (tab == null) return;\r\n            tab.setVisible(show);\r\n        }\r\n    }\r\n}\r\n"],"sourceRoot":"/source/"}